<?xml version="1.0"?>
<openerp>
    <data>
         <!-- Server Action:-->
         <record id="ir_publish_selected_master_product_wordpress_server_action" model="ir.actions.server">
             <field name="name">Pubblica WP master</field>
             <field name="type">ir.actions.server</field>
             <field name="model_id" ref="model_product_product_web_server" />
             <field name="binding_model_id" ref="model_product_product_web_server" />
             <field name="state">code</field>
             <field name="code">action = env['product.product.web.server'].publish_master_now()</field>
         </record>

        <!--product.product.web.server
        <record model="ir.ui.view" id="view_product_product_web_server_wp_form">
            <field name="name">product.product.web.server.form</field>
            <field name="model">product.product.web.server</field>
            <field name="priority" eval="40"/>
            <field name="arch" type="xml">

            </field>
        </record>-->

        <record model="ir.ui.view" id="view_wordpress_connector_form">
            <field name="name">connector.server.attribute.form</field>
            <field name="model">connector.server</field>
            <field name="inherit_id" ref="connector_web_base.view_connector_server_form"/>
            <field name="arch" type="xml">
                <xpath expr="//header/button" position="after">
                    <button name="publish_attribute_now" string="Publish attribute" type="object"
                        confirm="Export product attribute where managed, confirm?"
                        class="oe_highlight" icon="gtk-refresh" attrs="{'invisible': [('wordpress','=',False)]}" />
                </xpath>
                <field name="name" position="after">
                    <field name="brand_code" />
                    <field name="dot_image_path" colspan="4" />
                </field>
            </field>
        </record>

        <!--connector.product.color.dot-->
        <record model="ir.ui.view" id="view_connector_product_color_dot_tree">
            <field name="name">connector.product.color.dot.tree</field>
            <field name="model">connector.product.color.dot</field>
            <field name="arch" type="xml">
                <tree string="String" colors="grey:not_active==True">
                    <field name="connector_id" />
                    <field name="not_active" />
                    <field name="name" />
                    <field name="code" />
                    <!--<field name="description" />-->
                    <field name="hint" />
                    <field name="image_name" />
                    <!--<field name="dropbox_image" />-->
                </tree>
            </field>
        </record>
        <record model="ir.ui.view" id="view_connector_product_color_dot_bottom_tree">
            <field name="name">connector.product.color.dot.bottom.tree</field>
            <field name="model">connector.product.color.dot</field>
            <field name="arch" type="xml">
                <tree string="String" colors="grey:not_active==True" editable="bottom">
                    <field name="connector_id" />
                    <field name="not_active" />
                    <field name="name" />
                    <field name="code" />
                    <!--<field name="description" />-->
                    <field name="hint" />
                    <field name="image_name" />
                    <!--<field name="dropbox_image" />-->
                </tree>
            </field>
        </record>
        <record model="ir.ui.view" id="view_connector_product_color_dot_form">
            <field name="name">connector.product.color.dot.form</field>
            <field name="model">connector.product.color.dot</field>
            <field name="arch" type="xml">
                <form string="Colori Dot">
                    <sheet>
                        <group colspan="4" col="4">
                            <field name="connector_id" />
                            <field name="code" />

                            <field name="not_active" />
                            <field name="name" />

                            <field name="description" />
                            <field name="hint" />

                            <separator string="Image not present:" colspan="4" attrs="{'invisible': [('image_present','=',True)]}" />
                            <separator string="Image present:" colspan="4" attrs="{'invisible': [('image_present','=',False)]}" />
                            <field name="image_name" />
                            <field name="image_fullname" />
                            <field name="image_present" invisible="1" />
                        </group>
                    </sheet>
                </form>
            </field>
        </record>
        <record model="ir.actions.act_window" id="action_connector_product_color_dot">
            <field name="name">Dot colore</field>
            <field name="res_model">connector.product.color.dot</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="view_connector_product_color_dot_tree"/>
            <field name="context">{}</field>
            <field name="domain">[]</field>
        </record>
        <record model="ir.actions.act_window" id="action_connector_product_color_dot_bottom">
            <field name="name">Dot colore lista</field>
            <field name="res_model">connector.product.color.dot</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="view_connector_product_color_dot_bottom_tree"/>
            <field name="context">{}</field>
            <field name="domain">[]</field>
        </record>

        <!--product.product.web.server-->
        <record model="ir.ui.view" id="view_product_product_web_server_integration_search">
            <field name="name">product.product.web.server.parent.search</field>
            <field name="model">product.product.web.server</field>
            <field name="inherit_id" ref="connector_web_product.view_product_web_server_search"/>
            <field name="arch" type="xml">
                <field name="product_id" position="after">
                    <field name="product_id" string="Codice" filter_domain="[('product_id.default_code','ilike',self)]"/>
                </field>
            </field>
        </record>

        <record model="ir.ui.view" id="view_product_product_web_server_wp_parent_tree">
            <field name="name">product.product.web.server.parent.tree</field>
            <field name="model">product.product.web.server</field>
            <field name="priority" eval="40"/>
            <field name="arch" type="xml">
                <tree string="Product" color="blue:wp_parent_code!=False">
                    <field name="published"/>
                    <field name="product_id" />
                    <field name="connector_id" />
                    <field name="wp_color_id" />
                    <field name="wp_type" />
                    <field name="wp_parent_code" />
                    <field name="variant_ids" />
                    <field name="wordpress_categ_ids" domain="[('connector_id', '=', connector_id), ('enabled', '=', True)]"/>
                    <field name="wp_it_id" invisible="1"/>
                    <field name="wp_en_id" invisible="1" />
                    <!--<field name="force_name"/>
                    <field name="force_description"/>
                    <field name="force_q_x_pack"/>
                    <field name="force_ean13"/>
                    <field name="force_price"/>
                    <field name="force_min_stock"/>-->
                    <button name="publish_master_now" string="Publish this now" type="object" icon="gtk-refresh"/>
                    <button name="publish_master_now" string="Non pubblicato" type="object" icon="gtk-new" attrs="{'invisible': ['|', ('wp_it_id', '!=', 0), ('wp_en_id', '!=', 0)]}"/>
                </tree>
            </field>
        </record>
        <record model="ir.ui.view" id="view_product_product_web_server_wp_variant_tree">
            <field name="name">product.product.web.server.variant.tree</field>
            <field name="model">product.product.web.server</field>
            <field name="priority" eval="40"/>
            <field name="arch" type="xml">
                <tree string="Product" editable="bottom">
                    <field name="published" readonly="1"/>
                    <field name="product_id" readonly="1" />
                    <field name="connector_id" readonly="1"/>
                    <field name="wp_color_id" />
                    <field name="wp_type" readonly="1"/>
                    <field name="wordpress_categ_ids" domain="[('connector_id', '=', connector_id), ('enabled', '=', True)]" readonly="1" widget="many2many_tags"/>
                    <field name="wp_parent_id" readonly="1"/>
                    <field name="wp_parent_code" />
                    <!--<button name="set_as_master_product" string="Diventa master" type="object" attrs="{'invisible': [('wp_parent_code','=',True)]}"/>-->
                </tree>
            </field>
        </record>

        <record model="ir.ui.view" id="view_product_product_web_server_wp_full_detail_form">
            <field name="name">product.product.web.server.full.detail.form</field>
            <field name="model">product.product.web.server</field>
            <field name="priority" eval="40"/>
            <field name="arch" type="xml">
                <form string="Product" version="7.0">
                    <header>
                    </header>
                    <sheet>
                        <group colspan="4" col="4">
                            <field name="connector_id" />
                            <field name="published" />

                            <field name="product_id" required="1"/>
                            <field name="wp_parent_code" />

                            <field name="brand_id" />

                            <notebook colspan="4">
                                <page string="Info">
                                    <group colspan="4" col="4">
                                        <field name="wp_type" groups="wp_connector.group_wp_product_manager"/>
                                        <field name="wp_parent_template" groups="wp_connector.group_wp_product_manager"/>

                                        <field name="wp_parent_id" groups="wp_connector.group_wp_product_manager" domain="[('connector_id','=',connector_id)]"/>
                                        <field name="wp_color_id" />

                                        <field name="wordpress_categ_ids" domain="[('connector_id','=',connector_id),('enabled','=',True)]" widget="many2many_tags" colspan="4"/>

                                        <field name="lst_price" />
                                        <field name="lifetime_warranty" />

                                        <field name="price_multi" />
                                        <field name="price_extra" />
                                    </group>
                                </page>
                                <!--<page string="Linked">
                                    <group colspan="4" col="4">
                                        <field name="linked_ids" domain="[('id', '!=', active_id), ('connector_id', '=', connector_id)]" widget="many2many_tags"/>
                                    </group>
                                </page>-->
                                <page string="Material">
                                    <group colspan="4" col="4">
                                        <field name="material_ids" widget="many2many_tags"/>
                                    </group>
                                </page>
                                <page string="Package">
                                    <group colspan="4" col="4">
                                        <field name="model_package_id" />
                                        <separator string="Da anagrafica prodotto:" colspan="4" /><!--attrs="{'invisible': [('model_package_id','!=',False)]}"-->
                                        <field name="product_pack_l" />
                                        <field name="product_pack_h" />
                                        <field name="product_pack_p" />

                                        <field name="product_weight" />
                                        <!--<field name="product_weight_net" />-->

                                        <field name="product_q_x_pack" />

                                        <separator string="Preview del sito:" colspan="4" /><!--attrs="{'invisible': [('model_package_id','!=',False)]}"-->
                                        <field name="pack_l" />
                                        <field name="pack_h" />
                                        <field name="pack_p" />
                                        <field name="weight" />

                                        <separator string="Dimensioni prodotto" colspan="4" />
                                        <button name="update_wp_volume" string="Refresh volume" type="object" colspan="1"  attrs="{'invisible': [('wp_manual_volume', '=', True)]}"/>
                                        <field name="wp_manual_volume" />
                                        <field name="wp_volume" />
                                        <field name="weight_aditional_info" colspan="4" nolabel="1"/>

                                        <field name="q_x_pack" />
                                        <!--<field name="weight_net" />-->

                                    </group>
                                </page>
                                <page string="Forzature">
                                    <group colspan="4" col="4">
                                        <field name="force_name"/>
                                        <field name="force_description"/>

                                        <field name="force_q_x_pack"/>
                                        <field name="force_ean13"/>

                                        <field name="force_price"/>
                                        <field name="force_min_stock"/>
                                    </group>
                                </page>
                                <page string="Emozionali">
                                    <group colspan="4" col="4">
                                        <separator string="Emozionale breve" colspan="4"/>
                                        <field name="emotional_short_description" colspan="4" nolabel="1"/>
                                        <separator string="Emozionale lungha" colspan="4"/>
                                        <field name="emotional_description" colspan="4" nolabel="1"/>
                                    </group>
                                </page>
                            </notebook>

                            <separator string="Wordpress link:" colspan="4"/>
                            <field name="wp_it_id" readonly="1"/>
                            <field name="wp_en_id" readonly="1"/>
                        </group>
                    </sheet>
                </form>
            </field>
        </record>
        <record model="ir.ui.view" id="view_product_product_web_server_wp_parent_form">
            <field name="name">product.product.web.server.parent.form</field>
            <field name="model">product.product.web.server</field>
            <field name="priority" eval="40"/>
            <field name="arch" type="xml">
                <form string="Product" version="7.0">
                    <header>
                        <!--<button name="publish_now" string="Publish now" type="object" />-->
                        <button name="link_variant_now" string="Collega tutti figli" type="object" />
                    </header>
                    <sheet>
                        <group colspan="4" col="4">
                            <field name="connector_id" readonly="1"/>
                            <newline/>

                            <field name="published" readonly="1"/>
                            <field name="wp_type" readonly="1"/>

                            <field name="product_id" readonly="1" />
                            <field name="wp_parent_code" />

                            <field name="wp_color_id" />
                            <newline/>

                            <field name="wordpress_categ_ids" domain="[('connector_id','=',connector_id),('enabled','=',True)]" widget="many2many_tags" colspan="4"/>

                            <!--<field name="force_name"/>
                            <field name="force_description"/>

                            <field name="force_q_x_pack"/>
                            <field name="force_ean13"/>

                            <field name="force_price"/>
                            <field name="force_min_stock"/>-->

                            <notebook colspan="4">
                                <page string="Variations:">
                                     <group colspan="4" col="4">
                                        <separator string="Wordpress line:" colspan="4"/>
                                        <!--<button name="clean_reference" string="Clean reference" colspan="1" type="object" confirm="Do you want delete reference with Wordpress linked product?"/>-->
                                        <field name="variant_ids" colspan="4" nolabel="1" readonly="1">
                                            <tree string="Varianti" editable="bottom">
                                                <field name="published" />
                                                <field name="product_id" readonly="1" />
                                                <field name="force_q_x_pack" readonly="1"/>
                                                <field name="force_ean13" readonly="1"/>
                                                <field name="force_price" readonly="1"/>
                                                <button name="open_master_variant" string="Apri" type="object" />
                                            </tree>
                                        </field>
                                     </group>
                                </page>
                                <page string="Linked:">
                                     <group colspan="4" col="4">
                                         <field name="linked_ids" domain="[('id', '!=', active_id), ('connector_id', '=', connector_id), ('wp_parent_template', '=', True)]" widget="many2many_tags"/>
                                     </group>
                                </page>
                            </notebook>

                            <separator string="Wordpress link:" colspan="3"/>
                            <button name="clean_wp_reference" string="Clean" type="object" confirm="Clean WP reference only if this product is deleted from WP, confirm?" colspan="1" attrs="{'invisible': [('wp_it_id','=',0), ('wp_en_id','=',0)]}"/>
                            <field name="wp_it_id" groups="wp_connector.group_wp_product_manager"/>
                            <field name="wp_en_id" groups="wp_connector.group_wp_product_manager"/>
                        </group>
                    </sheet>
                </form>
            </field>
        </record>
        <record model="ir.actions.act_window" id="action_product_product_parent_tree">
            <field name="name">Prodotto master</field>
            <field name="res_model">product.product.web.server</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="view_product_product_web_server_wp_parent_tree"/>
            <field name="context">{'form_view_ref': 'wp_attribute.view_product_product_web_server_wp_parent_form'}</field>
            <field name="domain">[('wp_parent_template', '=', True)]</field>
        </record>
        <record model="ir.actions.act_window" id="action_product_product_variant_tree">
            <field name="name">Prodotto variant</field>
            <field name="res_model">product.product.web.server</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_product_product_web_server_wp_variant_tree"/>
            <field name="domain">[('connector_id.wordpress', '=', True), ('wp_parent_template', '=', False)]</field>
        </record>
        <!-- OVERRIDED: -->
        <record model="ir.actions.act_window" id="wp_connector.action_product_product_web_server_form">
            <field name="name">Product published</field>
            <field name="res_model">product.product.web.server</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="wp_connector.view_product_product_web_server_wp_tree"/>
            <field name="context">{'form_view_ref': 'wp_attribute.view_product_product_web_server_wp_full_detail_form'}</field>
            <field name="domain">[('connector_id.wordpress', '=', True)]</field>
        </record>

        <menuitem
            parent="wp_connector.menu_connector_worppress_root"
            id="menu_product_product_parent"
            action="action_product_product_parent_tree"
            sequence="10"
            />
            <menuitem
                parent="menu_product_product_parent"
                id="menu_product_product_variant"
                action="action_product_product_variant_tree"
                sequence="10"
                />
        <menuitem
            parent="wp_connector.menu_connector_worppress_configuration"
            id="menu_action_connector_product_color_dot"
            action="action_connector_product_color_dot"
            sequence="30"
            />
            <menuitem
                parent="menu_action_connector_product_color_dot"
                id="menu_action_connector_product_color_dot_bottom"
                action="action_connector_product_color_dot_bottom"
                sequence="10"
                />


    </data>
</openerp>
