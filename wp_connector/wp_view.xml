<?xml version="1.0"?>
<openerp>
    <data>    
        <!--connector_web_base.view_connector_server_tree-->
        <record model="ir.ui.view" id="view_wordpress_connector_tree">
            <field name="name">connector.server.tree</field>
            <field name="model">connector.server</field>
            <field name="inherit_id" ref="connector_web_base.view_connector_server_tree"/>
            <field name="arch" type="xml">
                <field name="name" position="before">
                    <field name="wordpress" />
                </field>
            </field>
        </record>
        <record model="ir.ui.view" id="view_wordpress_connector_form">
            <field name="name">connector.server.form</field>
            <field name="model">connector.server</field>
            <field name="inherit_id" ref="connector_web_base.view_connector_server_form"/>
            <field name="arch" type="xml">
                <xpath expr="//header/button" position="after">
                    <button name="extract_wordpress_published_report" string="List published" type="object" confirm="Extract all information published, could take time, confirm?" class="oe_highlight" icon="gtk-print" attrs="{'invisible': [('wordpress','=',False)]}"/>
                </xpath>

                <field name="name" position="before">
                    <field name="wordpress" />
                </field>

                <field name="host" position="attributes">
                    <attribute name="required">0</attribute>
                    <attribute name="attrs">{'required': [('wordpress', '=', False)], 'invisible': [('wordpress', '=', True)]}</attribute>
                </field>
                <field name="port" position="attributes">
                    <attribute name="required">0</attribute>
                    <attribute name="attrs">{'required': [('wordpress', '=', False)], 'invisible': [('wordpress', '=', True)]}</attribute>
                </field>
                
                <field name="database" position="attributes">
                    <attribute name="required">0</attribute>
                    <attribute name="attrs">{'required': [('wordpress', '=', False)], 'invisible': [('wordpress', '=', True)]}</attribute>
                </field>
                <field name="username" position="attributes">
                    <attribute name="required">0</attribute>
                    <attribute name="attrs">{'required': [('wordpress', '=', False)], 'invisible': [('wordpress', '=', True)]}</attribute>
                </field>
                <field name="password" position="attributes">
                    <attribute name="required">0</attribute>
                    <attribute name="attrs">{'required': [('wordpress', '=', False)], 'invisible': [('wordpress', '=', True)]}</attribute>
                </field>
                <field name="album_id" position="attributes">
                    <attribute name="required">0</attribute>
                    <attribute name="attrs">{'required': [('wordpress', '=', False)], 'invisible': [('wordpress', '=', True)]}</attribute>
                </field>
                
                <!--<button name="publish_all_connector" position="before">
                    <button name="wordpress_import_category" string="Load category" type="object" attrs="{'invisible': [('wordpress','=',False)]}"/>
                    <button name="wordpress_rsync_photo" string="Upload all photo" type="object" attrs="{'invisible': [('wordpress','=',False)]}"/>
                    <button name="auto_select_product_button" string="Select stock product" type="object" attrs="{'invisible': [('wordpress','=',False)]}"/>
                </button>-->

                <field name="password" position="after">                     
                    <group colspan="4" col="4" attrs="{'invisible': [('wordpress','=',False)]}">                    
                        <separator string="Wordpress block:" colspan="4"/>
                        <field name="wp_url" attrs="{'required': [('wordpress', '=', True)]}"/>
                        <field name="wp_key" attrs="{'required': [('wordpress', '=', True)]}"/>
                        
                        <field name="wp_secret" attrs="{'required': [('wordpress', '=', True)]}"/>
                        <field name="wp_api" attrs="{'required': [('wordpress', '=', True)]}"/>

                        <field name="wp_version" attrs="{'required': [('wordpress', '=', True)]}"/>
                        <field name="album_ids" widget="many2many_tags"/>

                        <field name="wp_category" />
                        <field name="wp_all_category" />

                    </group>
                </field>
            </field>
        </record>

        <record model="ir.ui.view" id="view_product_product_web_server_form">
            <field name="name">product.product.web.server.form</field>
            <field name="model">product.product.web.server</field>
            <field name="priority" eval="40" />
            <field name="arch" type="xml">
                <form string="String" version="7.0">        
                    <sheet>
                        <group col="4" colspan="4">
                            <field name="connector_id" readonly="1"/>
                            <field name="product_id" readonly="1" />
                            <field name="published" />
                            <field name="public_categ_id" domain="[('connector_id', '=', connector_id), ('enabled', '=', True)]"/>
                            
                            <separator string="Images:" colspan="4"/>
                            <field name="wp_dropbox_images_ids" editable="bottom" colspan="4" nolabel="1">
                                <tree string="Image album" colors="red:status=='product';grey:status=='removed';blue:status=='modify';green:status=='ok';brown:status=='format';black:variant==True" editable="bottom">
                                     <field name="album_id" readonly="1" />
                                     <field name="filename" readonly="1" />
                                     <field name="variant" readonly="1" />
                                     <field name="variant_code" readonly="1" />
                                     <field name="status" readonly="1" />
                                     <field name="dropbox_link" readonly="1" />
                                </tree>
                            </field>
                        </group>
                    </sheet>        
                </form>
            </field>
        </record>
        <record model="ir.ui.view" id="view_product_web_server_publish_image_tree">
            <field name="name">product.product.publish.image.tree</field>
            <field name="model">product.product.web.server</field>
            <field name="inherit_id" ref="connector_web_product.view_product_web_server_publish_tree"/>
            <field name="arch" type="xml">
                <button name="publish_now" position="before">
                    <field name="wordpress" invisible="1" />
                    <button name="open_image_list_product" string="Image" type="object" attrs="{'invisible': [('wordpress','=',False)]}" icon="terp-purchase"/>
                </button>
            </field>
        </record>

        <!--CUSTOM: product.product.web.server-->        
        <record model="ir.ui.view" id="view_product_product_web_server_wp_tree">
            <field name="name">product.product.web.server.tree</field>
            <field name="model">product.product.web.server</field>
            <field name="priority" eval="40"/>
            <field name="arch" type="xml">
                <tree string="Product" color="red:published==False">
                    <field name="published"/>
                    <field name="product_id" readonly="1" invisible="context.get('embedded_view', False)"/>
                    <field name="connector_id" />
                    <field name="wordpress_categ_ids" domain="[('connector_id', '=', connector_id), ('enabled', '=', True)]"/>
                    <field name="force_name"/>
                    <field name="force_description"/>
                    <field name="force_q_x_pack"/>
                    <field name="force_ean13"/>
                    <field name="force_price"/>
                    <field name="force_min_stock"/>
                    <button name="publish_now" string="Publish now" type="object"/>
                </tree>           
            </field>
        </record>
        <record model="ir.ui.view" id="view_product_product_web_server_wp_form">
            <field name="name">product.product.web.server.form</field>
            <field name="model">product.product.web.server</field>
            <field name="priority" eval="40"/>
            <field name="arch" type="xml">
                <form string="Product" version="7.0">
                    <header>
                        <button name="publish_now" string="Publish now" type="object" />
                    </header>
                    <group colspan="4" col="4">
                        <field name="published"/>
                        <field name="connector_id" />                        
                        <field name="product_id" readonly="1" invisible="context.get('embedded_view', False)"/>

                        <field name="wordpress_categ_ids" domain="[('connector_id','=',connector_id),('enabled','=',True)]" widget="many2many_tags"/>

                        <field name="force_name"/>
                        <field name="force_description"/>
                        <field name="force_q_x_pack"/>
                        <field name="force_ean13"/>
                        <field name="force_price"/>
                        <field name="force_min_stock"/>
                    </group>    
                </form>           
            </field>
        </record>
        <record model="ir.actions.act_window" id="action_product_product_web_server_form">
            <field name="name">Product published</field>
            <field name="res_model">product.product.web.server</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="view_product_product_web_server_wp_tree"/>
            <field name="context">{'form_view_ref': 'wp_connector.view_product_product_web_server_wp_form'}</field>
            <field name="domain">[('connector_id.wordpress', '=', True)]</field>
        </record>
        <menuitem 
            parent="connector_web_base.menu_webserver_root" 
            id="menu_connector_worppress_root" 
            name="Manage Wordpress"
            sequence="20"
            />
            <menuitem 
                parent="menu_connector_worppress_root" 
                id="menu_connector_worppress_product" 
                action="action_product_product_web_server_form"
                sequence="10"
                />
            <menuitem 
                parent="menu_connector_worppress_root" 
                id="menu_connector_worppress_configuration" 
                name="Configuration"
                sequence="99"
                />
                
          
    </data>
</openerp>
